<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get started • tidygam</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidygam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/get-started.html">Get started</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stefanocoretta/tidygam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stefanocoretta/tidygam/blob/v1.0.0/vignettes/get-started.Rmd" class="external-link"><code>vignettes/get-started.Rmd</code></a></small>
      <div class="d-none name"><code>get-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stefanocoretta/tidygam" class="external-link">tidygam</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mgcv</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: nlme</span></span>
<span><span class="co">#&gt; This is mgcv 1.9-1. For overview type 'help("mgcv-package")'.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">#&gt;   object 'type_sum.accel' not found</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:nlme':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     collapse</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The tidymv package offers two main user-oriented functions:</p>
<ul>
<li><p><code><a href="../reference/predict_gam.html">predict_gam()</a></code>: returns predictions of the outcome
variable based on the predictors in the GAM model. The user can specify
specific values for any predictor, and exclude model terms.</p></li>
<li><p><code><a href="../reference/get_difference.html">get_difference()</a></code>: returns the difference between two
smooths and those intervals along the smooth that do not include
0.</p></li>
</ul>
<p>The output of these function can then be plotted with
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>, through the methods <code><a href="../reference/plot.tidygam.html">plot.tidygam()</a></code> and
<code><a href="../reference/plot.tidygam.diff.html">plot.tidygam.diff()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="basic-model-prediction">Basic model prediction<a class="anchor" aria-label="anchor" href="#basic-model-prediction"></a>
</h2>
<p>Let’s start with a simple model and get model-based predictions.</p>
<p>We will use the <code>gest</code> data table, available in tidygam.
The table consists of counts of gestures performed by infants of three
cultural backgrounds who participating in a longitudinal study (see
<code><a href="../reference/gest.html">?gest</a></code> for details and references).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gest"</span><span class="op">)</span></span>
<span><span class="va">gest</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 540 × 5</span></span></span>
<span><span class="co">#&gt;    dyad  background months gesture count</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> b01   Bengali        10 ho_gv       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> b01   Bengali        10 point       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> b01   Bengali        10 reach       5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> b01   Bengali        11 ho_gv       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> b01   Bengali        11 point       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> b01   Bengali        11 reach       8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> b01   Bengali        12 ho_gv       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> b01   Bengali        12 point       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> b01   Bengali        12 reach       0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> b02   Bengali        10 ho_gv       1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 530 more rows</span></span></span></code></pre></div>
<p>The following GAM models the overall trend in number of gestures from
10 to 12 months of age.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">months</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gest</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; count ~ s(months, k = 3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.27491    0.02361   53.99   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;             edf Ref.df Chi.sq p-value    </span></span>
<span><span class="co">#&gt; s(months) 1.861  1.981  248.9  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.0372   Deviance explained = 6.61%</span></span>
<span><span class="co">#&gt; UBRE = 6.1921  Scale est. = 1         n = 540</span></span></code></pre></div>
<p>Now we can obtain the predicted counts with
<code><a href="../reference/predict_gam.html">predict_gam()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span>
<span><span class="va">gs_pred</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 5</span></span></span>
<span><span class="co">#&gt;    months count     se lower_ci[,1] upper_ci[,1]</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   10   0.768 0.049<span style="text-decoration: underline;">8</span>        0.670        0.865</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   10.2 0.896 0.039<span style="text-decoration: underline;">6</span>        0.818        0.973</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   10.4 1.02  0.034<span style="text-decoration: underline;">0</span>        0.954        1.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   10.6 1.14  0.033<span style="text-decoration: underline;">4</span>        1.07         1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   10.8 1.25  0.035<span style="text-decoration: underline;">2</span>        1.18         1.32 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   11   1.35  0.036<span style="text-decoration: underline;">3</span>        1.28         1.42 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   11.2 1.44  0.034<span style="text-decoration: underline;">6</span>        1.37         1.51 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   11.4 1.51  0.030<span style="text-decoration: underline;">8</span>        1.45         1.58 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   11.6 1.58  0.026<span style="text-decoration: underline;">9</span>        1.53         1.64 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   11.8 1.65  0.026<span style="text-decoration: underline;">5</span>        1.59         1.70 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>   12   1.71  0.031<span style="text-decoration: underline;">5</span>        1.64         1.77</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-predicted-values">Plot predicted values<a class="anchor" aria-label="anchor" href="#plot-predicted-values"></a>
</h2>
<p><code><a href="../reference/predict_gam.html">predict_gam()</a></code> returns an object of class
<code>tidygam</code>, which can be plotted with <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<p>The user has to specify the “series” used as the <em>x</em>-axis. The
outcome variable is automatically selected for the <em>y</em>-axis.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_pred</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>series <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-pred-plot-1.png" width="672"></p>
<p>Since the <code>gs</code> model used a log-link function, the output
of <code><a href="../reference/predict_gam.html">predict_gam()</a></code> is in log-odds, rather than in counts.</p>
<p>We can convert the log-odds to counts by exponentiating them. The
<code>tran_fun</code> argument allows the user to specify a function to
transform the predicted outcome values with.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span><span class="va">gs</span>, tran_fun <span class="op">=</span> <span class="va">exp</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>series <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-pred-exp-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="models-with-by-variables">Models with <code>by</code>-variables<a class="anchor" aria-label="anchor" href="#models-with-by-variables"></a>
</h2>
<p>Smooths can be fitted to different levels of a factor using so-called
<code>by</code>-variables, specified within the smooth function
<code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code> with the <code>by</code> argument. Note that smooths
are automatically centred so you need to include the
<code>by</code>-variable as a parametric term too.</p>
<p>In this model, we fit a smooth along <code>months</code> for each
background in the data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_by</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="va">background</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">months</span>, by <span class="op">=</span> <span class="va">background</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gest</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs_by</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; count ~ background + s(months, by = background, k = 3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)        1.36119    0.03930  34.634  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; backgroundChinese -0.06916    0.05694  -1.215  0.22451    </span></span>
<span><span class="co">#&gt; backgroundEnglish -0.21696    0.05814  -3.731  0.00019 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                               edf Ref.df Chi.sq p-value    </span></span>
<span><span class="co">#&gt; s(months):backgroundBengali 1.935  1.996  83.24  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):backgroundChinese 1.003  1.006 143.06  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):backgroundEnglish 1.000  1.000  42.38  &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.0384   Deviance explained = 7.72%</span></span>
<span><span class="co">#&gt; UBRE = 6.1223  Scale est. = 1         n = 540</span></span></code></pre></div>
<p>The predictor for comparison is selected with the
<code>comparison</code> argument in <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_by</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span>length_out <span class="op">=</span> <span class="fl">20</span>, series <span class="op">=</span> <span class="st">"months"</span>, tran_fun <span class="op">=</span> <span class="va">exp</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"background"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-by-comp-1.png" width="672"></p>
<p>Note that the output of <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> is a ggplot2 object,
which can be modified using ggplot2 functions.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_by</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span>length_out <span class="op">=</span> <span class="fl">20</span>, series <span class="op">=</span> <span class="st">"months"</span>, tran_fun <span class="op">=</span> <span class="va">exp</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"background"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-by-comp-2-1.png" width="672"></p>
<p>Let’s try now a model with both <code>gesture</code> and
<code>background</code> as <code>by</code>-variables.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_by_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="va">gesture</span> <span class="op">+</span> <span class="va">background</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">months</span>, by <span class="op">=</span> <span class="va">background</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">months</span>, by <span class="op">=</span> <span class="va">gesture</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gest</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs_by_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; count ~ gesture + background + s(months, by = background, k = 3) + </span></span>
<span><span class="co">#&gt;     s(months, by = gesture, k = 3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)        1.63549    0.04821  33.927  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; gesturepoint      -0.41072    0.05695  -7.213 5.49e-13 ***</span></span>
<span><span class="co">#&gt; gesturereach      -0.53554    0.05791  -9.248  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; backgroundChinese -0.06937    0.05693  -1.219 0.222975    </span></span>
<span><span class="co">#&gt; backgroundEnglish -0.21719    0.05812  -3.737 0.000186 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                                   edf    Ref.df Chi.sq  p-value    </span></span>
<span><span class="co">#&gt; s(months):backgroundBengali 1.9226651 1.9925158 54.925  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):backgroundChinese 1.1043907 1.1961394 84.781  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):backgroundEnglish 1.0009022 1.0017885 28.978  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):gestureho_gv      1.0014574 1.0028600  4.207   0.0403 *  </span></span>
<span><span class="co">#&gt; s(months):gesturepoint      0.0003739 0.0007391  0.000   0.9959    </span></span>
<span><span class="co">#&gt; s(months):gesturereach      1.2383962 1.4167559 25.127 1.51e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank: 16/17</span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.0824   Deviance explained =   13%</span></span>
<span><span class="co">#&gt; UBRE = 5.7338  Scale est. = 1         n = 540</span></span></code></pre></div>
<p>Note that models like this one are conceptually equivalent to linear
models without interactions between the <code>by</code>-variables.</p>
<p>This is clear when plotting the predictions: notice how the shapes of
the smooths are very similar within each background, and they only
differ in slope (this is the effect of including separate
<code>by</code>-variables).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_by_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span>length_out <span class="op">=</span> <span class="fl">20</span>, series <span class="op">=</span> <span class="st">"months"</span>, tran_fun <span class="op">=</span> <span class="va">exp</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"gesture"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">background</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-by-2-plot-1.png" width="672"></p>
<p>If you wish to plot the effect of specific <code>by</code>-variables,
you can exclude terms like in the following code chunk. Note that the
name of terms has to match precisely the name in the model summary and
that you should exclude both parametric and smooth terms with the same
<code>by</code>-variable. You also need to pick any level of the
excluded variable (otherwise the predictions will be repeated for each
level in the excluded variable, but since the variable is excluded, the
predictions will be the same).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">to_exclude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s(months):gestureho_gv"</span>, <span class="st">"s(months):gesturepoint"</span>, <span class="st">"s(months):gesturereach"</span>,</span>
<span>                <span class="st">"gesturepoint"</span>, <span class="st">"gesturereach"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs_by_2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span>length_out <span class="op">=</span> <span class="fl">20</span>, series <span class="op">=</span> <span class="st">"months"</span>, tran_fun <span class="op">=</span> <span class="va">exp</span>,</span>
<span>              exclude_terms <span class="op">=</span> <span class="va">to_exclude</span>,</span>
<span>              <span class="co"># pick any value of the excluded variables.</span></span>
<span>              values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gesture <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"background"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-by-2-plot-2-1.png" width="672"></p>
<p>The following section illustrates how to specify and plot models with
the GAM equivalent of classical interactions
(e.g. <code>background * gesture</code>).</p>
</div>
<div class="section level2">
<h2 id="models-with-factor-interactions">Models with factor interactions<a class="anchor" aria-label="anchor" href="#models-with-factor-interactions"></a>
</h2>
<p>Classical interactions between factors as usually obtained in linear
models with the <code>:</code> syntax
(e.g. <code>background:gesture</code>) are not possible in GAMs.</p>
<p>An alternative way to specify what are called interactions in
generalised linear models is by creating a new factor which is the
interaction of the two or more factors using the
<code><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction()</a></code> function, and include this “factor
interaction” predictors as a <code>by</code>-variable.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gest</span> <span class="op">&lt;-</span> <span class="va">gest</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>back_gest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">background</span>, <span class="va">gesture</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>  <span class="va">count</span> <span class="op">~</span> <span class="va">back_gest</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">months</span>, by <span class="op">=</span> <span class="va">back_gest</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">gest</span>,</span>
<span>  family <span class="op">=</span> <span class="va">poisson</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs_i</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: poisson </span></span>
<span><span class="co">#&gt; Link function: log </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; count ~ back_gest + s(months, by = back_gest, k = 3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                        Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)             1.76112    0.05783  30.452  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; back_gestChinese.ho_gv  0.01249    0.08045   0.155   0.8766    </span></span>
<span><span class="co">#&gt; back_gestEnglish.ho_gv -0.87624    0.10592  -8.273  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; back_gestBengali.point -1.07758    0.11358  -9.487  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; back_gestChinese.point -1.05327    0.12189  -8.641  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; back_gestEnglish.point -0.19015    0.08283  -2.296   0.0217 *  </span></span>
<span><span class="co">#&gt; back_gestBengali.reach -0.48164    0.08943  -5.386 7.22e-08 ***</span></span>
<span><span class="co">#&gt; back_gestChinese.reach -0.81182    0.09928  -8.177 2.91e-16 ***</span></span>
<span><span class="co">#&gt; back_gestEnglish.reach -1.03646    0.10751  -9.640  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                                    edf Ref.df Chi.sq  p-value    </span></span>
<span><span class="co">#&gt; s(months):back_gestBengali.ho_gv 1.773  1.949 87.901  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):back_gestChinese.ho_gv 1.002  1.003 72.955  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):back_gestEnglish.ho_gv 1.001  1.002 40.670  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):back_gestBengali.point 1.941  1.997 22.153 2.08e-05 ***</span></span>
<span><span class="co">#&gt; s(months):back_gestChinese.point 1.001  1.001 91.257  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(months):back_gestEnglish.point 1.000  1.000  8.542  0.00347 ** </span></span>
<span><span class="co">#&gt; s(months):back_gestBengali.reach 1.738  1.931  2.725  0.19781    </span></span>
<span><span class="co">#&gt; s(months):back_gestChinese.reach 1.749  1.937  3.538  0.11830    </span></span>
<span><span class="co">#&gt; s(months):back_gestEnglish.reach 1.000  1.000  4.261  0.03902 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.0999   Deviance explained = 18.8%</span></span>
<span><span class="co">#&gt; UBRE = 5.3243  Scale est. = 1         n = 540</span></span></code></pre></div>
<p>When predicting values, the user can use the <code>separate</code>
argument to specify factor-interaction variables in the model that can
be split back into their individual components.</p>
<p>This gives greater flexibility when plotting.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">gs_i</span>, tran_fun <span class="op">=</span> <span class="va">exp</span>,</span>
<span>  separate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>back_gest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"background"</span>, <span class="st">"gesture"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>series <span class="op">=</span> <span class="st">"months"</span>, comparison <span class="op">=</span> <span class="st">"gesture"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">background</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/gs-i-plot-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="models-with-factor-smooth-interactions-bs-fs">Models with factor smooth interactions (<code>bs = "fs"</code>)<a class="anchor" aria-label="anchor" href="#models-with-factor-smooth-interactions-bs-fs"></a>
</h2>
<p>Factor smooth interactions are the GAM equivalent of
random/group-level effects (intercepts and slopes).</p>
<p>Let’s work with the <code>struct</code> data, which contains
event-related potentials measures of subjects listening to music and
speech. For each type (music vs language), the stimuli were either
“grammatical” or “ungrammatical” (i.e. the stimuli either respected
structural rules or they did not).</p>
<p>This is a subset of the original data, including voltage values only
for electrode 62.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"struct"</span><span class="op">)</span></span>
<span><span class="va">struct</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,400 × 7</span></span></span>
<span><span class="co">#&gt;        t electrode voltage subject stimulus.condition grammar.condition</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>  -<span style="color: #BB0000;">100</span>        62 -<span style="color: #BB0000;">0.315</span>  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   -<span style="color: #BB0000;">90</span>        62 -<span style="color: #BB0000;">0.320</span>  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   -<span style="color: #BB0000;">80</span>        62 -<span style="color: #BB0000;">0.297</span>  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   -<span style="color: #BB0000;">70</span>        62 -<span style="color: #BB0000;">0.628</span>  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   -<span style="color: #BB0000;">60</span>        62 -<span style="color: #BB0000;">1.05</span>   03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   -<span style="color: #BB0000;">50</span>        62 -<span style="color: #BB0000;">0.734</span>  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   -<span style="color: #BB0000;">40</span>        62  0.054<span style="text-decoration: underline;">4</span> 03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   -<span style="color: #BB0000;">30</span>        62  0.623  03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   -<span style="color: #BB0000;">20</span>        62  1.05   03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   -<span style="color: #BB0000;">10</span>        62  1.14   03      Language           Grammatical      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,390 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: stim_gram &lt;fct&gt;</span></span></span></code></pre></div>
<p>Let’s fit the model with factor smooth interactions
(<code>bs = "fs"</code>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">struct</span> <span class="op">&lt;-</span> <span class="va">struct</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>stim_gram <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">stimulus.condition</span>, <span class="va">grammar.condition</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam</a></span><span class="op">(</span></span>
<span>  <span class="va">voltage</span> <span class="op">~</span> <span class="va">stim_gram</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">t</span>, by <span class="op">=</span> <span class="va">stim_gram</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">subject</span>, bs <span class="op">=</span> <span class="st">"fs"</span>, m <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">struct</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">st</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; voltage ~ stim_gram + s(t, by = stim_gram, k = 5) + s(t, subject, </span></span>
<span><span class="co">#&gt;     bs = "fs", m = 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parametric coefficients:</span></span>
<span><span class="co">#&gt;                                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                      0.61210    0.19052   3.213  0.00132 ** </span></span>
<span><span class="co">#&gt; stim_gramMusic.Grammatical       0.22318    0.09401   2.374  0.01763 *  </span></span>
<span><span class="co">#&gt; stim_gramLanguage.Ungrammatical -0.98969    0.09401 -10.528  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; stim_gramMusic.Ungrammatical     0.37377    0.09401   3.976 7.12e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate significance of smooth terms:</span></span>
<span><span class="co">#&gt;                                         edf Ref.df      F p-value    </span></span>
<span><span class="co">#&gt; s(t):stim_gramLanguage.Grammatical    2.846  3.249  2.889 0.02137 *  </span></span>
<span><span class="co">#&gt; s(t):stim_gramMusic.Grammatical       2.627  3.022  4.243 0.00531 ** </span></span>
<span><span class="co">#&gt; s(t):stim_gramLanguage.Ungrammatical  3.270  3.629  1.620 0.09791 .  </span></span>
<span><span class="co">#&gt; s(t):stim_gramMusic.Ungrammatical     3.848  3.962 26.467 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; s(t,subject)                         50.511 89.000  6.597 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R-sq.(adj) =  0.202   Deviance explained = 21.4%</span></span>
<span><span class="co">#&gt; fREML = 9800.7  Scale est. = 4.8605    n = 4400</span></span></code></pre></div>
<p>When predicting values we want to exclude the factor smooth
interaction, as we would with random/group-level effects in linear
models.</p>
<p>Note that GAM terms to be excluded must be specified as they are
named in the output of <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">st</span>,</span>
<span>  length_out <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  series <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  exclude_terms <span class="op">=</span> <span class="st">"s(t,subject)"</span>,</span>
<span>  <span class="co"># Pick any subject: since we are removing the random effect, it does not</span></span>
<span>  <span class="co"># matter which one you pick, the predictions will be the same</span></span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>subject <span class="op">=</span> <span class="st">"03"</span><span class="op">)</span>,</span>
<span>  separate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stim_gram <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stimulus"</span>, <span class="st">"grammar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"grammar"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">stimulus</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/st-plot-1.png" width="672"></p>
<p>If the fs interaction is not removed, the predicted smooth for each
individual level in the fs interaction is returned.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/predict_gam.html">predict_gam</a></span><span class="op">(</span></span>
<span>  <span class="va">st</span>,</span>
<span>  length_out <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  series <span class="op">=</span> <span class="st">"t"</span>,</span>
<span>  separate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stim_gram <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"stimulus"</span>, <span class="st">"grammar"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>comparison <span class="op">=</span> <span class="st">"grammar"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span> <span class="va">stimulus</span><span class="op">)</span></span></code></pre></div>
<p><img src="get-started_files/figure-html/st-plot-2-1.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stefano Coretta.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
